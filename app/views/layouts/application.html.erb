<!DOCTYPE html>
<html>
  <head>
    <title>RecruitmentPortal</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  </head>

  <body>
	  
    <div class="nav_bar page-header">
      <div class="nav_bar_title">
		  <img src="/Images/Logo.png">
	  </div>
      <div class="nav_bar_menu">
        <ul>

          <% if user_signed_in? %>
            <li>
				<div class="dropdown">
					<div class="welcome_message">
						Welcome <b><%= current_user.profile.name %></b>
					</div>
				  <button class="dropbtn">
					  <%= link_to current_user.profile, :style=>"padding:0px" do %>
					  <% if current_user.profile.photo.blank? %>
					  <img src="https://st.depositphotos.com/2101611/3925/v/600/depositphotos_39258143-stock-illustration-businessman-avatar-profile-picture.jpg" />
					  <% else  %>
					  <img src="<%=current_user.profile.photo.url%>">
					  <% end %>
					  
					  <% end %>
				  </button>
				  <div class="dropdown-content">
				    <%= link_to 'Edit Profile', edit_profile_path(current_user.profile.id,role:current_user.profile.role.downcase) %>
	                <a rel="nofollow" data-method="delete" href="/users/sign_out">
	                  Logout
	                </a>
				  </div>
				</div>
			</li>
          <% else %>
            <li> 
              <a href="/users/sign_in"> 
                <i class="material-icons" style="font-size:20px;color:#FFF;">login</i> 
                <span> Login</span>
              </a> 
            </li>
          <% end %>
        </ul>
      </div>
      <div class="clr"></div>
    </div>
    <div class="ap_container page-body">

      <% if user_signed_in? %>
	  
	  <div class="menu">
		  <ul>
			  <li class="option <%= (controller_name == "profiles" && action_name=="show") ? "menu_item_selected" : "" %>">
				  <%= link_to "Home", root_path %>
			  </li>
  		</ul>
	  <%if current_user.is_admin? %>
	  <ul>
		  <li class="heading"><a> Admin Options </a></li>
	  	<li class="option"> <a href="/account_managers"> Manage Account Managers </a> </li>
	  </ul>
	  <% end %>
	  <%if current_user.is_account_manager? %>
	  <ul>
		  <li class="option <%= action_name=="time_sheet_approval" ? "menu_item_selected" : "" %>"> 
			  <a href="/account_managers/time_sheet_approval?order=status"> Timesheet Management </a> 
		  </li>
	  </ul>
	  <% end %>
	 
    <%if current_user.is_admin? || current_user.is_account_manager? %>
      <ul>
        <li class="option <%= controller_name=="vendors" ? "jos" : "" %>"> <a onclick="alert('In Progress!')">User Management</a> </li>
      </ul>
	  
	  <ul>
        
		<li class="option <%= controller_name=="vendors" ? "menu_item_selected" : "" %>"> <a href="/vendors"> Prime Vendors </a> </li>
		<li class="option <%= controller_name=="clients" ? "menu_item_selected" : "" %>"> <a href="/clients"> Clients </a> </li>
		<li class="option <%= controller_name=="employees" ? "menu_item_selected" : "" %>"> <a href="/employees"> Consultants </a> </li>
		<li class="option <%= controller_name=="employers" ? "menu_item_selected" : "" %>"> <a href="/employers"> Employers </a> </li>
		
      </ul>
	  
      <ul>
        
		<li class="option <%= controller_name=="vendors" ? "jos" : "" %>"> <a onclick="alert('In Progress!')">Jobs</a> </li>
		<li class="option <%= controller_name=="clients" ? "reports" : "" %>"> <a onclick="alert('In Progress!')">Reports</a> </li>
		<li class="option <%= controller_name=="employees" ? "invoices" : "" %>"> <a onclick="alert('In Progress!')">Invoices</a> </li>
		
      </ul>
	  
    <%elsif current_user.profile.role == "Employee" %>
        <%@employee = @employee.nil? ? current_user.profile.employee : @employee %>
        <ul style="<%= params["prv"] == "true" ? "display:none" : "" %>" >
          <li class="option <%= (controller_name == "employees" && action_name=="show") ? "menu_item_selected" : "" %>"> 
			  <a href="/employees/<%=@employee.id%>">Weekly Time Report </a> 
		  </li>
        </ul>
        <%if @employee.present?%>
          <ul style="<%= params["prv"] == "true" ? "" : "display:none"%>">
            <li id="back" style="cursor:pointer;"><a>Back</a></li>
            <%keys = @employee.work_durations.group_by{|w| ["#{w.work_day.beginning_of_week.strftime("%B %d, %Y")}", w.time_sheet_status]}.keys.to_h%>
            <%(3.month.ago.to_datetime..Date.today).select(&:monday?).map{|d| d.strftime("%B %d, %Y")}.each do |date|%>
              <li style="margin: 0 0 10px 0;">
               <%= link_to date,weekly_wise_data_work_durations_url(date:date,eid:@employee.id,prv: "true"),:class =>
                keys["#{date}"].present? ? keys["#{date}"]+"-menu" : "pending-menu" %>
               <!--  <a class="" href=""></a> -->
            </li>
            <%end%>
          </ul>
        <%end%>
    <%elsif current_user.profile.role == "Assistant"%>
        <ul>
          <li class="option"> <a href="/account_managers/time_sheet_approval?order=status"> Time Sheet Approval </a> </li>
          <li class="option"> <a href="/vendors"> Vendor Wise Reports </a> </li>
        </ul>
	<% end %>
  </div>
    <% end %>

<div class="top_info flex_row">
	<% if !notice.blank? || !alert.blank? %>
	<div class="notification_container flex_col">
		<div style="float:left">
			<% if !notice.blank? %>
			<p id="notice"><%= notice %></p>
			<% end %>
			<% if !alert.blank? %>
			<p id="alert"><b>ERROR:</b> <%= alert %></p>
			<% end %>
		</div>
		<div style="float:right"><a href="">close</a></div>
	</div>
	<% end %>
	<div class="date_container flex_col" style="width:400px;text-align:right">
		<b>Date:</b> <%= Date.today.strftime("%A %B %d, %Y") %>
	</div>
</div>
<div class="main_page_title">
	<%= @title %>
</div>
<% if user_signed_in? %>
  <div class="main" >
<% else %>
  <div class="main" style="width:100%">
<% end %>
	
    <%= yield %>
</div>
<div style="clear:both"></div>

</div>
    
	<div class="page-footer">
		<div class="footer_content" style="display:flex;flex-direction:row;justify-content: space-evenly;color:#FFF;margin-left:auto;margin-right:auto;font-family: Roboto;">
			<div class="footer_message" style="line-height:60px;font-size:14px">
				Â© 2021 Vertex IT Systems. Component copyrights belongs to their authors.  
			</div>
			<div class="footer_actions" style="float:left;font-size:12px;line-height:14px;padding-top:10px">
				<span class="footer_action_title" style="padding-right:36px;"> Email:      </span> <a mailto="support@vertexitservice.com">support@vertexitservice.com</a> <br />
				<span class="footer_action_title" style="padding-right:5px;"> Contact No: </span> <a href="#">Contact</a> <br />
				<span class="footer_action_title" style="padding-right:22px;"> Website:    </span> <a href="http://vertexitservice.com">www.vertexitservice.com</a> <br />
			</div>
	</div>
  </body>
</html>
